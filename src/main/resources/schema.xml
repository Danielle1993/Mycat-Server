<?xml version="1.0"?>
<!DOCTYPE mycat:schema SYSTEM "schema.dtd">
<mycat:schema xmlns:mycat="http://io.mycat/">

        <schema name="pay-mycat" checkSQLschema="false" sqlMaxLimit="100">
                <!-- auto sharding by id (long) -->
                <table name="user_quick_pay_info" primaryKey="ID" dataNode="dn1,dn2" rule="auto-sharding-long" />
                <table name="user_pay_info" primaryKey="ID" dataNode="dn1,dn2" rule="sharding-by-murmur" />
                <table name="user_gather_info" primaryKey="ID" dataNode="dn1,dn2" rule="sharding-by-gather_channel">
                        <childTable name="user_gather_info_log" joinKey="gather_id" parentKey="id" >
                        </childTable>
                </table>
				<table name="bank_code_data" primaryKey="ID" dataNode="dn1,dn2" type="global" />

        </schema>
        
        <dataNode name="dn1" dataHost="data1" database="pay-bak" />
        <dataNode name="dn2" dataHost="data2" database="pay-test" />
        
        <!-- 	1. balance="0", 不开启读写分离机制，所有读操作都发送到当前可用的 writeHost 上。
				2. balance="1"，全部的 readHost 与 stand by writeHost 参与 select 语句的负载均衡，简单的说，当双
								主双从模式(M1->S1，M2->S2，并且 M1 与 M2 互为主备)，正常情况下，M2,S1,S2 都参与 select 语句的负载均衡。
				3. balance="2"，所有读操作都随机的在 writeHost、readhost 上分发。
				4. balance="3"，所有读请求随机的分发到 wiriterHost 对应的 readhost 执行，writerHost 不负担读压力，
								注意 balance=3 只在 1.4 及其以后版本有，1.3 没有。 -->
								
		<!-- 	1. writeType="0", 所有写操作发送到配置的第一个 writeHost，第一个挂了切到还生存的第二个 writeHost，
							      重新启动后已切换后的为准，切换记录在配置文件中:dnindex.properties .
				2. writeType="1"，所有写操作都随机的发送到配置的 writeHost，1.5 以后废弃不推荐。 -->
				
		<!-- 	switchType="-1" 表示不自动切换
				switchType="1" 默认值，自动切换
				switchType="2" 基于 MySQL 主从同步的状态决定是否切换 心跳语句为 show slave status
				switchType="3" 基于 MySQL galary cluster 的切换机制（适合集群）（1.4.1） 心跳语句为 show status like ‘wsrep%’ -->
        <dataHost name="data1" maxCon="1000" minCon="10" balance="1"
                          writeType="0" dbType="mysql" dbDriver="native" switchType="2"  slaveThreshold="100">
                <heartbeat>show slave status</heartbeat>
                <!-- can have multi write hosts -->
                <writeHost host="hostM1" url="172.16.4.114:3306" user="pay"
                                   password="pay-dev@123">
                        <!-- can have multi read hosts -->
                        <readHost host="hostS1" url="172.16.4.115:3306" user="pay" password="pay-dev@123" />
                </writeHost>
        </dataHost>
        
        <dataHost name="data2" maxCon="1000" minCon="10" balance="1"
                          writeType="0" dbType="mysql" dbDriver="native" switchType="2"  slaveThreshold="100">
                <heartbeat>select user()</heartbeat>
                <!-- can have multi write hosts -->
                <writeHost host="hostM2" url="172.16.4.114:3306" user="pay"
                                   password="pay-dev@123">
                        <!-- can have multi read hosts -->
                        <readHost host="hostS2" url="172.16.4.115:3306" user="pay" password="pay-dev@123" />
                </writeHost>
        </dataHost>
</mycat:schema>